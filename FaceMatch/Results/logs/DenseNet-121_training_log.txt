
==============================================================
DenseNet-121 Gender Classification
==============================================================

Project: COSC595 Information Technology Project: Implementation
Model: DenseNet-121
Task: Binary Gender Classification (Male/Female)

==============================================================

Device Configuration:
	Utilising Device: CUDA
	GPU Name: NVIDIA GeForce RTX 3080 Ti
	GPU Memory: 11 GB


---------------
Loading Dataset
---------------

Loading dataset attributes from:
	C:\\Users\\carlf\\Desktop\\COSC595 - Models and Datasets\\CelebA\\list_attr_celeba.csv

Loaded Images from CSV file:
	202599 images

Overall Gender Statistics:
	Female: 118165 (58.3% Female),
	Male: 84434 (41.7% Male)

--------------------------------------------------------------
TRAINING Set: 162079 images (80%)
--------------------------------------------------------------

Training Gender Distribution:
	Female: 94532 (58.3% Female),
	Male: 67547 (41.7% Male)

--------------------------------------------------------------
VALIDATION Set: 20260 images (10%)
--------------------------------------------------------------

Validation Gender Distribution:
	Female: 11816 (58.3% Female),
	Male: 8444 (41.7% Male)

--------------------------------------------------------------
TESTING Set: 20260 images (10%)
--------------------------------------------------------------

Testing Gender distribution:
	Female: 11817 (58.3% Female),
	Male: 8443 (41.7% Male)

Dataset loaded successfully!

==============================================================
Initialising DenseNet-121 Model
==============================================================

Model Configuration:
	Growth Rate: 32
	Dense Layer Dropout: 0.2
	Number of Classes: 2 (Male/Female)

Model Statistics:
	Total Parameters: 6,955,906
	Trainable Parameters: 6,955,906
	Model Size: 26.5 MB
	Memory Footprint: ~53 MB (including gradients)

==============================================================
Starting Training Phase
==============================================================

Output directories verified/created successfully

Starting training for 40 epochs

--------------------------------------------------------------
Epoch 1/40
--------------------------------------------------------------



Epoch 1 Results:
	Training Loss: 0.1910, Training Accuracy: 91.93%
	Validation Loss: 0.1546, Validation Accuracy: 93.73%
	Precision: 0.9333, Recall: 0.9422, F1: 0.9363
	Learning Rate: 0.001000


Validation Accuracy: 93.73%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 2/40
--------------------------------------------------------------



Epoch 2 Results:
	Training Loss (TL): 0.1075, Training Accuracy (TA): 95.84%
	Validation Loss (VL): 0.0947, Validation Accuracy (VA): 96.35%
	Precision: 0.9644, Recall: 0.9605, F1: 0.9623
	Learning Rate (LR): 0.000999


Validation Accuracy: 96.35%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 3/40
--------------------------------------------------------------



Epoch 3 Results:
	Training Loss (TL): 0.0930, Training Accuracy (TA): 96.50%
	Validation Loss (VL): 0.0769, Validation Accuracy (VA): 97.15%
	Precision: 0.9710, Recall: 0.9704, F1: 0.9707
	Learning Rate (LR): 0.000998


Validation Accuracy: 97.15%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 4/40
--------------------------------------------------------------



Epoch 4 Results:
	Training Loss (TL): 0.0829, Training Accuracy (TA): 96.91%
	Validation Loss (VL): 0.0661, Validation Accuracy (VA): 97.56%
	Precision: 0.9740, Recall: 0.9759, F1: 0.9749
	Learning Rate (LR): 0.000996


Validation Accuracy: 97.56%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 5/40
--------------------------------------------------------------



Epoch 5 Results:
	Training Loss (TL): 0.0774, Training Accuracy (TA): 97.13%
	Validation Loss (VL): 0.0668, Validation Accuracy (VA): 97.46%
	Precision: 0.9726, Recall: 0.9755, F1: 0.9739
	Learning Rate (LR): 0.000994


Validation Accuracy: 97.46%   |   


--------------------------------------------------------------
Epoch 6/40
--------------------------------------------------------------



Epoch 6 Results:
	Training Loss (TL): 0.0735, Training Accuracy (TA): 97.24%
	Validation Loss (VL): 0.0670, Validation Accuracy (VA): 97.48%
	Precision: 0.9742, Recall: 0.9741, F1: 0.9741
	Learning Rate (LR): 0.000991


Validation Accuracy: 97.48%   |   


--------------------------------------------------------------
Epoch 7/40
--------------------------------------------------------------



Epoch 7 Results:
	Training Loss (TL): 0.0701, Training Accuracy (TA): 97.40%
	Validation Loss (VL): 0.0902, Validation Accuracy (VA): 96.45%
	Precision: 0.9682, Recall: 0.9594, F1: 0.9632
	Learning Rate (LR): 0.000988


Validation Accuracy: 96.45%   |   


--------------------------------------------------------------
Epoch 8/40
--------------------------------------------------------------



Epoch 8 Results:
	Training Loss (TL): 0.0690, Training Accuracy (TA): 97.44%
	Validation Loss (VL): 0.0610, Validation Accuracy (VA): 97.76%
	Precision: 0.9767, Recall: 0.9774, F1: 0.9770
	Learning Rate (LR): 0.000984


Validation Accuracy: 97.76%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 9/40
--------------------------------------------------------------



Epoch 9 Results:
	Training Loss (TL): 0.0669, Training Accuracy (TA): 97.51%
	Validation Loss (VL): 0.0668, Validation Accuracy (VA): 97.62%
	Precision: 0.9739, Recall: 0.9775, F1: 0.9756
	Learning Rate (LR): 0.000980


Validation Accuracy: 97.62%   |   


--------------------------------------------------------------
Epoch 10/40
--------------------------------------------------------------



Epoch 10 Results:
	Training Loss (TL): 0.0652, Training Accuracy (TA): 97.58%
	Validation Loss (VL): 0.0600, Validation Accuracy (VA): 97.82%
	Precision: 0.9787, Recall: 0.9764, F1: 0.9775
	Learning Rate (LR): 0.000976


Validation Accuracy: 97.82%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 11/40
--------------------------------------------------------------



Epoch 11 Results:
	Training Loss (TL): 0.0645, Training Accuracy (TA): 97.66%
	Validation Loss (VL): 0.0665, Validation Accuracy (VA): 97.52%
	Precision: 0.9749, Recall: 0.9740, F1: 0.9744
	Learning Rate (LR): 0.000970


Validation Accuracy: 97.52%   |   


--------------------------------------------------------------
Epoch 12/40
--------------------------------------------------------------



Epoch 12 Results:
	Training Loss (TL): 0.0635, Training Accuracy (TA): 97.68%
	Validation Loss (VL): 0.0703, Validation Accuracy (VA): 97.38%
	Precision: 0.9712, Recall: 0.9758, F1: 0.9732
	Learning Rate (LR): 0.000965


Validation Accuracy: 97.38%   |   


--------------------------------------------------------------
Epoch 13/40
--------------------------------------------------------------



Epoch 13 Results:
	Training Loss (TL): 0.0633, Training Accuracy (TA): 97.65%
	Validation Loss (VL): 0.0591, Validation Accuracy (VA): 97.74%
	Precision: 0.9761, Recall: 0.9775, F1: 0.9768
	Learning Rate (LR): 0.000959


Validation Accuracy: 97.74%   |   


--------------------------------------------------------------
Epoch 14/40
--------------------------------------------------------------



Epoch 14 Results:
	Training Loss (TL): 0.0616, Training Accuracy (TA): 97.73%
	Validation Loss (VL): 0.0515, Validation Accuracy (VA): 98.04%
	Precision: 0.9801, Recall: 0.9796, F1: 0.9798
	Learning Rate (LR): 0.000952


Validation Accuracy: 98.04%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 15/40
--------------------------------------------------------------



Epoch 15 Results:
	Training Loss (TL): 0.0607, Training Accuracy (TA): 97.77%
	Validation Loss (VL): 0.0561, Validation Accuracy (VA): 97.89%
	Precision: 0.9771, Recall: 0.9798, F1: 0.9784
	Learning Rate (LR): 0.000946


Validation Accuracy: 97.89%   |   


--------------------------------------------------------------
Epoch 16/40
--------------------------------------------------------------



Epoch 16 Results:
	Training Loss (TL): 0.0602, Training Accuracy (TA): 97.77%
	Validation Loss (VL): 0.0525, Validation Accuracy (VA): 97.99%
	Precision: 0.9784, Recall: 0.9804, F1: 0.9794
	Learning Rate (LR): 0.000938


Validation Accuracy: 97.99%   |   


--------------------------------------------------------------
Epoch 17/40
--------------------------------------------------------------



Epoch 17 Results:
	Training Loss (TL): 0.0598, Training Accuracy (TA): 97.82%
	Validation Loss (VL): 0.0512, Validation Accuracy (VA): 98.08%
	Precision: 0.9808, Recall: 0.9798, F1: 0.9803
	Learning Rate (LR): 0.000930


Validation Accuracy: 98.08%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 18/40
--------------------------------------------------------------



Epoch 18 Results:
	Training Loss (TL): 0.0589, Training Accuracy (TA): 97.83%
	Validation Loss (VL): 0.0722, Validation Accuracy (VA): 97.16%
	Precision: 0.9686, Recall: 0.9740, F1: 0.9709
	Learning Rate (LR): 0.000922


Validation Accuracy: 97.16%   |   


--------------------------------------------------------------
Epoch 19/40
--------------------------------------------------------------



Epoch 19 Results:
	Training Loss (TL): 0.0591, Training Accuracy (TA): 97.83%
	Validation Loss (VL): 0.0547, Validation Accuracy (VA): 98.02%
	Precision: 0.9809, Recall: 0.9784, F1: 0.9796
	Learning Rate (LR): 0.000914


Validation Accuracy: 98.02%   |   


--------------------------------------------------------------
Epoch 20/40
--------------------------------------------------------------



Epoch 20 Results:
	Training Loss (TL): 0.0575, Training Accuracy (TA): 97.91%
	Validation Loss (VL): 0.0543, Validation Accuracy (VA): 98.08%
	Precision: 0.9804, Recall: 0.9803, F1: 0.9803
	Learning Rate (LR): 0.000905


Validation Accuracy: 98.08%   |   


--------------------------------------------------------------
Epoch 21/40
--------------------------------------------------------------



Epoch 21 Results:
	Training Loss (TL): 0.0578, Training Accuracy (TA): 97.88%
	Validation Loss (VL): 0.0512, Validation Accuracy (VA): 98.17%
	Precision: 0.9819, Recall: 0.9804, F1: 0.9811
	Learning Rate (LR): 0.000895


Validation Accuracy: 98.17%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 22/40
--------------------------------------------------------------



Epoch 22 Results:
	Training Loss (TL): 0.0566, Training Accuracy (TA): 97.95%
	Validation Loss (VL): 0.0481, Validation Accuracy (VA): 98.31%
	Precision: 0.9822, Recall: 0.9831, F1: 0.9826
	Learning Rate (LR): 0.000885


Validation Accuracy: 98.31%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 23/40
--------------------------------------------------------------



Epoch 23 Results:
	Training Loss (TL): 0.0571, Training Accuracy (TA): 97.92%
	Validation Loss (VL): 0.0502, Validation Accuracy (VA): 98.24%
	Precision: 0.9817, Recall: 0.9821, F1: 0.9819
	Learning Rate (LR): 0.000875


Validation Accuracy: 98.24%   |   


--------------------------------------------------------------
Epoch 24/40
--------------------------------------------------------------



Epoch 24 Results:
	Training Loss (TL): 0.0554, Training Accuracy (TA): 98.02%
	Validation Loss (VL): 0.0637, Validation Accuracy (VA): 97.76%
	Precision: 0.9752, Recall: 0.9793, F1: 0.9771
	Learning Rate (LR): 0.000864


Validation Accuracy: 97.76%   |   


--------------------------------------------------------------
Epoch 25/40
--------------------------------------------------------------



Epoch 25 Results:
	Training Loss (TL): 0.0559, Training Accuracy (TA): 97.97%
	Validation Loss (VL): 0.0530, Validation Accuracy (VA): 98.25%
	Precision: 0.9820, Recall: 0.9820, F1: 0.9820
	Learning Rate (LR): 0.000854


Validation Accuracy: 98.25%   |   


--------------------------------------------------------------
Epoch 26/40
--------------------------------------------------------------



Epoch 26 Results:
	Training Loss (TL): 0.0558, Training Accuracy (TA): 97.99%
	Validation Loss (VL): 0.0558, Validation Accuracy (VA): 97.96%
	Precision: 0.9777, Recall: 0.9806, F1: 0.9790
	Learning Rate (LR): 0.000842


Validation Accuracy: 97.96%   |   


--------------------------------------------------------------
Epoch 27/40
--------------------------------------------------------------



Epoch 27 Results:
	Training Loss (TL): 0.0555, Training Accuracy (TA): 98.03%
	Validation Loss (VL): 0.0455, Validation Accuracy (VA): 98.45%
	Precision: 0.9842, Recall: 0.9839, F1: 0.9841
	Learning Rate (LR): 0.000831


Validation Accuracy: 98.45%   |   [92mThe new best model - Saved![0m


--------------------------------------------------------------
Epoch 28/40
--------------------------------------------------------------



Epoch 28 Results:
	Training Loss (TL): 0.0549, Training Accuracy (TA): 97.98%
	Validation Loss (VL): 0.0602, Validation Accuracy (VA): 97.81%
	Precision: 0.9760, Recall: 0.9795, F1: 0.9776
	Learning Rate (LR): 0.000819


Validation Accuracy: 97.81%   |   


--------------------------------------------------------------
Epoch 29/40
--------------------------------------------------------------



Epoch 29 Results:
	Training Loss (TL): 0.0544, Training Accuracy (TA): 98.00%
	Validation Loss (VL): 0.0539, Validation Accuracy (VA): 98.13%
	Precision: 0.9803, Recall: 0.9813, F1: 0.9808
	Learning Rate (LR): 0.000806


Validation Accuracy: 98.13%   |   


--------------------------------------------------------------
Epoch 30/40
--------------------------------------------------------------



Epoch 30 Results:
	Training Loss (TL): 0.0542, Training Accuracy (TA): 98.04%
	Validation Loss (VL): 0.0508, Validation Accuracy (VA): 98.18%
	Precision: 0.9824, Recall: 0.9802, F1: 0.9813
	Learning Rate (LR): 0.000794


Validation Accuracy: 98.18%   |   


--------------------------------------------------------------
Epoch 31/40
--------------------------------------------------------------



Epoch 31 Results:
	Training Loss (TL): 0.0538, Training Accuracy (TA): 98.07%
	Validation Loss (VL): 0.0509, Validation Accuracy (VA): 98.23%
	Precision: 0.9811, Recall: 0.9827, F1: 0.9819
	Learning Rate (LR): 0.000781


Validation Accuracy: 98.23%   |   


--------------------------------------------------------------
Epoch 32/40
--------------------------------------------------------------



Epoch 32 Results:
	Training Loss (TL): 0.0530, Training Accuracy (TA): 98.12%
	Validation Loss (VL): 0.0504, Validation Accuracy (VA): 98.26%
	Precision: 0.9826, Recall: 0.9817, F1: 0.9821
	Learning Rate (LR): 0.000768


Validation Accuracy: 98.26%   |   


--------------------------------------------------------------
Epoch 33/40
--------------------------------------------------------------



Epoch 33 Results:
	Training Loss (TL): 0.0521, Training Accuracy (TA): 98.12%
	Validation Loss (VL): 0.0489, Validation Accuracy (VA): 98.19%
	Precision: 0.9815, Recall: 0.9813, F1: 0.9814
	Learning Rate (LR): 0.000755


Validation Accuracy: 98.19%   |   


--------------------------------------------------------------
Epoch 34/40
--------------------------------------------------------------



Epoch 34 Results:
	Training Loss (TL): 0.0519, Training Accuracy (TA): 98.11%
	Validation Loss (VL): 0.0658, Validation Accuracy (VA): 97.60%
	Precision: 0.9734, Recall: 0.9780, F1: 0.9755
	Learning Rate (LR): 0.000741


Validation Accuracy: 97.60%   |   


--------------------------------------------------------------
Epoch 35/40
--------------------------------------------------------------



Epoch 35 Results:
	Training Loss (TL): 0.0522, Training Accuracy (TA): 98.17%
	Validation Loss (VL): 0.0489, Validation Accuracy (VA): 98.15%
	Precision: 0.9804, Recall: 0.9817, F1: 0.9810
	Learning Rate (LR): 0.000727


Validation Accuracy: 98.15%   |   


--------------------------------------------------------------
Epoch 36/40
--------------------------------------------------------------



Epoch 36 Results:
	Training Loss (TL): 0.0509, Training Accuracy (TA): 98.16%
	Validation Loss (VL): 0.0477, Validation Accuracy (VA): 98.30%
	Precision: 0.9824, Recall: 0.9826, F1: 0.9825
	Learning Rate (LR): 0.000713


Validation Accuracy: 98.30%   |   


--------------------------------------------------------------
Epoch 37/40
--------------------------------------------------------------



Epoch 37 Results:
	Training Loss (TL): 0.0512, Training Accuracy (TA): 98.17%
	Validation Loss (VL): 0.0460, Validation Accuracy (VA): 98.36%
	Precision: 0.9824, Recall: 0.9838, F1: 0.9831
	Learning Rate (LR): 0.000699


Validation Accuracy: 98.36%   |   


--------------------------------------------------------------
Epoch 38/40
--------------------------------------------------------------



Epoch 38 Results:
	Training Loss (TL): 0.0499, Training Accuracy (TA): 98.18%
	Validation Loss (VL): 0.0490, Validation Accuracy (VA): 98.21%
	Precision: 0.9811, Recall: 0.9823, F1: 0.9816
	Learning Rate (LR): 0.000684


Validation Accuracy: 98.21%   |   


--------------------------------------------------------------
Epoch 39/40
--------------------------------------------------------------



Epoch 39 Results:
	Training Loss (TL): 0.0501, Training Accuracy (TA): 98.19%
	Validation Loss (VL): 0.0611, Validation Accuracy (VA): 97.85%
	Precision: 0.9761, Recall: 0.9802, F1: 0.9780
	Learning Rate (LR): 0.000669


Validation Accuracy: 97.85%   |   


--------------------------------------------------------------
Epoch 40/40
--------------------------------------------------------------



Epoch 40 Results:
	Training Loss (TL): 0.0495, Training Accuracy (TA): 98.22%
	Validation Loss (VL): 0.0449, Validation Accuracy (VA): 98.41%
	Precision: 0.9835, Recall: 0.9837, F1: 0.9836
	Learning Rate (LR): 0.000655


Validation Accuracy: 98.41%   |   


==============================================================
TRAINING COMPLETED
==============================================================

Best validation accuracy: 98.45% (Epoch 27)

==============================================================
Generating Training Visualisations
==============================================================

Starting comprehensive evaluation...
Model evaluation completed, calculating metrics...
Metrics calculated, generating plots...
Generating training curves...
Generating confusion matrix...
Generating ROC curve...
Generating metrics summary...
All plots generated successfully!

All plots generated successfully!

==============================================================
Testing DenseNet-121 model...
==============================================================

Evaluation Complete

Test Accuracy: 98.09%

Test Precision: 0.9807   |   Test Recall: 0.9801
Test F1-Score: 0.9804   |   Test ROC-AUC: 0.9984

==============================================================
=                    MODEL CYCLE COMPLETE                    =
==============================================================

==============================================================
FINAL RESULTS SUMMARY
==============================================================
Best Validation Accuracy: 98.45% (achieved at Epoch 27)
Final Test Accuracy: 98.09%
Final Test Loss: 0.0511
Final Test Precision: 0.9807
Final Test Recall: 0.9801
Final Test F1-Score: 0.9804
Model saved to: ../../Results/models/DenseNet-121_best.pth

Performance Analysis:
Excellent performance! Model achieved SOTA accuracy.
==============================================================
DenseNet-121 training completed successfully!
Check the Results directory for saved model, logs, and plots
==============================================================
==============================================================
ANALYZING MISCLASSIFIED IMAGES
==============================================================


Total misclassified images: 386
Results saved to: ../../Results/misclassified\DenseNet-121_misclassified_20251002_201004.csv

Misclassification Breakdown:
  Female → Male: 173 images
  Male → Female: 213 images

Sample Misclassifications (first 5):
  1. 022047.jpg
     True: Female, Predicted: Male
     Confidence - Female: 0.0377, Male: 0.9623
  2. 111414.jpg
     True: Male, Predicted: Female
     Confidence - Female: 0.9207, Male: 0.0793
  3. 146900.jpg
     True: Male, Predicted: Female
     Confidence - Female: 0.9879, Male: 0.0121
  4. 131185.jpg
     True: Male, Predicted: Female
     Confidence - Female: 0.8293, Male: 0.1707
  5. 009475.jpg
     True: Female, Predicted: Male
     Confidence - Female: 0.3614, Male: 0.6386
  ... and 381 more

==============================================================

==============================================================
